

{\setbeamercolor{background canvas}{bg=white}
	\begin{frame}[plain]
	
	\vspace{8em}
	\begin{center}
		\Huge\color{tumbluedark}
		\phantom{How }Should we deal with $\includegraphics[width=2em]{images/icons/cloud2_tumbluedark}^\ast$ at all?
	\end{center}\color{tumbluedark}
	\vspace{2em}
	\raggedleft \Large$^\ast$ ...and other noise in the data
	
	\vfill
	\vspace{6em}
	\raggedleft{\small \color{tumgray}
		Icons made by Smashicons from www.flaticon.com
	}
\end{frame}
}


\begin{frame}
\frametitle{Looking at single pixels}
\framesubtitle{Sentinel 2 (raw)}


\begin{tikzpicture}[baseline=-2em, inner sep=0]

\begin{axis}[
width=\textwidth,
%	hide axis,
height=5.5cm,
ymin=0, ymax=1.2,
%no marks,  
draw opacity=.8,
smooth=0.001,
legend style={at={(.65,1.1)},line width=2pt, draw opacity=1},
legend columns=3,
ylabel={reflectance},
xlabel={time $t$}
]


%\only<3->{
%	\node[draw=tumbluedark, rounded corners, inner sep=0, minimum width=.8em, minimum height=3em](xt) at (axis cs:16,0.155){};
%	\node (annotxt) at (axis cs:20,1){$\V{x}_t = 
%		\begin{pmatrix} \rho_\text{B02} \\ \dots \\ \rho_\text{B12} \end{pmatrix} = 
%		\left(\xtvector\right)$};
%	\draw[-stealth] (annotxt) -- (xt);
%}

\only<1>{
\addplot[b2color, tsmark] table [x=t, y=B02, col sep=comma]  {images/example/12-71459194_raw.csv};
\addplot[b3color, tsmark] table [x=t, y=B03, col sep=comma]  {images/example/12-71459194_raw.csv};
\addplot[b4color, tsmark] table [x=t, y=B04, col sep=comma]  {images/example/12-71459194_raw.csv};
\addplot[b5color, tsmark] table [x=t, y=B05, col sep=comma]  {images/example/12-71459194_raw.csv};
\addplot[b6color, tsmark] table [x=t, y=B06, col sep=comma]  {images/example/12-71459194_raw.csv};
\addplot[b7color, tsmark] table [x=t, y=B07, col sep=comma]  {images/example/12-71459194_raw.csv};
\addplot[b8color, tsmark] table [x=t, y=B08, col sep=comma]  {images/example/12-71459194_raw.csv};
\addplot[b8Acolor, tsmark] table [x=t, y=B8A, col sep=comma] {images/example/12-71459194_raw.csv};
\addplot[b11color, tsmark] table [x=t, y=B11, col sep=comma] {images/example/12-71459194_raw.csv};
\addplot[b12color, tsmark] table [x=t, y=B12, col sep=comma] {images/example/12-71459194_raw.csv};
\node[font=\Large](classannot) at (axis cs:25,1.1) {\textbf{meadow} \small(parcel 71459194)};
}

\only<2->{
\addplot[b2color, tsmark] table [x=t, y=B02, col sep=comma]  {images/example/27-71460294_raw.csv};
\addplot[b3color, tsmark] table [x=t, y=B03, col sep=comma]  {images/example/27-71460294_raw.csv};
\addplot[b4color, tsmark] table [x=t, y=B04, col sep=comma]  {images/example/27-71460294_raw.csv};
\addplot[b5color, tsmark] table [x=t, y=B05, col sep=comma]  {images/example/27-71460294_raw.csv};
\addplot[b6color, tsmark] table [x=t, y=B06, col sep=comma]  {images/example/27-71460294_raw.csv};
\addplot[b7color, tsmark] table [x=t, y=B07, col sep=comma]  {images/example/27-71460294_raw.csv};
\addplot[b8color, tsmark] table [x=t, y=B08, col sep=comma]  {images/example/27-71460294_raw.csv};
\addplot[b8Acolor, tsmark] table [x=t, y=B8A, col sep=comma] {images/example/27-71460294_raw.csv};
\addplot[b11color, tsmark] table [x=t, y=B11, col sep=comma] {images/example/27-71460294_raw.csv};
\addplot[b12color, tsmark] table [x=t, y=B12, col sep=comma] {images/example/27-71460294_raw.csv};
}
\only<2>{
\node[font=\Large](classannot) at (axis cs:25,1.1) {\textbf{wheat} \small(parcel 71460294)};
}


\end{axis}

\end{tikzpicture}

\end{frame}



\begin{frame}
\frametitle{Preprocessed versus Raw Data (Sentinel 2, Region Holl)}

\begin{tabular}{lrlrlrlrl}
\toprule
& \multicolumn{2}{c}{MS-ResNet} & \multicolumn{2}{c}{RNN (LSTM)} & \multicolumn{2}{c}{Transformer} & \multicolumn{2}{c}{TempCNN} \\
& acc. & $\kappa$ & acc. & $\kappa$ & acc. & $\kappa$ & acc. & $\kappa$ \\
\cmidrule(lr){2-3}\cmidrule(lr){4-5} \cmidrule(lr){6-7}\cmidrule(lr){8-9}
preprocessed & \textbf{0.8654} & \textbf{0.8360} & 0.7997 & 0.7513 & \textbf{0.8647} & \textbf{0.8363} & \textbf{0.8407} & \textbf{0.8034} \\
raw 		 & 0.8331 & 0.7971 & \textbf{0.8048} & \textbf{0.7611} & 0.7859 & 0.7420 & 0.7944 & 0.7462 \\
\bottomrule
\end{tabular}

\end{frame}

\begin{frame}
\frametitle{Radar}

\begin{tabular}{lrlrlrlrl}
\toprule
preprocessed data& \multicolumn{2}{c}{MS-ResNet} & \multicolumn{2}{c}{RNN (LSTM)} & \multicolumn{2}{c}{Transformer} & \multicolumn{2}{c}{TempCNN} \\
& acc. & $\kappa$ & acc. & $\kappa$ & acc. & $\kappa$ & acc. & $\kappa$ \\
\cmidrule(lr){2-3}\cmidrule(lr){4-5} \cmidrule(lr){6-7}\cmidrule(lr){8-9}
Sentinel 1 + Sentinel 2 	& x & x & 0.7983 & 0.7503 & 0.8384 & 0.8037 & x & x \\
Sentinel 2 (optical)	 	& x & x & 0.7845 & 0.7338 & 0.7936 & 0.7439 & x & x \\
Sentinel 1 (radar)		 	& x & x & 0.7305 & 0.6608 & 0.7471 & 0.6861 & x & x \\
\midrule \\
raw data \\
Sentinel 2 (optical) & 0.8331 & 0.7971 & \textbf{0.8048} & \textbf{0.7611} & 0.7859 & 0.7420 & 0.7944 & 0.7462 \\
\end{tabular}

\begin{tabular}{lrlrlrlrl}
\toprule
& \multicolumn{2}{c}{MS-ResNet} & \multicolumn{2}{c}{RNN (LSTM)} & \multicolumn{2}{c}{Transformer} & \multicolumn{2}{c}{TempCNN} \\
& acc. & $\kappa$ & acc. & $\kappa$ & acc. & $\kappa$ & acc. & $\kappa$ \\
\cmidrule(lr){2-3}\cmidrule(lr){4-5} \cmidrule(lr){6-7}\cmidrule(lr){8-9}
raw (optical)		 & 0.8331 & 0.7971 & \textbf{0.8048} & \textbf{0.7611} & 0.7859 & 0.7420 & 0.7944 & 0.7462 \\
\bottomrule
\end{tabular}

TODO experiments:
\begin{itemize}
\item multiple runs and report standard deviation
\item merge rows to one table
\end{itemize}

\end{frame}


%\input{images/examples.tex}
%\begin{frame}
%\frametitle{Qualitative Examples}
%%	\framesubtitle{ConvGRU with r=256 recurrent cells}
%\centering
%\begin{tikzpicture}
%\matrix (m) [matrix of nodes, ampersand replacement=\&, row sep=0pt, column sep=2mm]{
%	$\V{x}_{RGB,t}$ \& labels $\V{y}$ \& pred. $\hat{\V{y}}$ \& $H(\V{y},\hat{\V{y}}$) \& activation \& activation \& activation \& activation
%	\tileexample{16494}{maize}{maize}{meadow}{meadow}{peas}{peas}{rape}{rape}
%	\tileexample{8133}{winter_spelt}{spelt}{winter_wheat}{wheat}{summer_barley}{s.barley}{maize}{maize}
%	\tileexample{12894}{meadow}{meadow}{winter_wheat}{wheat}{potatoe}{potato}{maize}{maize}
%	%		\tileexample{1823}{meadow}{meadow}{winter_wheat}{wheat}{summer_oat}{oat}{maize}{maize}
%	\\
%};
%\makeexamplelegend
%\end{tikzpicture}
%\end{frame}

%\begin{frame}
%\frametitle{Qualitative Examples}
%%	\framesubtitle{ConvGRU with r=256 recurrent cells}
%\centering
%\begin{tikzpicture}
%\matrix (m) [matrix of nodes, ampersand replacement=\&, row sep=0pt, column sep=2mm]{
%$\V{x}_{RGB,t}$ \& labels $\V{y}$ \& pred. $\hat{\V{y}}$ \& $H(\V{y},\hat{\V{y}}$) \& activation \& activation \& activation \& activation
%\tileexample{10879}{winter_rye}{rye}{winter_triticale}{triticale}{summer_barley}{s.barley}{winter_barley}{w.barley}
%\tileexample{10792}{winter_rye}{rye}{winter_wheat}{wheat}{winter_triticale}{triticale}{summer_barley}{s.barley}
%%		\tileexample{10969}{winter_wheat}{wheat}{winter_triticale}{triticale}{winter_rye}{rye}{rape}{rape}
%\tileexample{172}{winter_wheat}{wheat}{meadow}{meadow}{maize}{maize}{winter_barley}{w.barley}
%\\
%};
%\makeexamplelegend
%\end{tikzpicture}
%\end{frame}


%\begin{frame}
%\frametitle{How did the ConvRNN handle the cloud noise?}
%
%We performed two experiments
%\begin{enumerate}
%	\item Visualization of internal network states. We found some hidden states that were sensitive 
%\end{enumerate}
%
%\end{frame}




%\begin{frame}
%\frametitle{Looking back at the Unreasonable Effectiveness of RNNs Blog}
%\texttt{http://karpathy.github.io/2015/05/21/rnn-effectiveness/}
%\includegraphics[width=\textwidth]{images/karpathy_charrnn}
%\end{frame}

%\input{images/activations.tikz}
%\begin{frame}
%\frametitle{Cloud Sensitive Cells}
%\framesubtitle{LSTM cell \textbf{47} of 256}
%\figactivations{1}{47}
%\end{frame}
%
%\begin{frame}
%\frametitle{Ablation Experiment on Cloudy Data}
%\input{images/clouds.tikz}
%\end{frame}



\begin{frame}[c]
\frametitle{Publications and Code}
\centering 

\Large



Github + DockerHub

\vspace{1ex}

\includegraphics[width=2cm]{images/github} \hspace{.5ex}
\includegraphics[width=2cm]{images/qr_github} \hspace{.5ex}
\includegraphics[width=2cm]{images/docker}

\vspace{1ex}

\url{https://github.com/TUM-LMF/MTLCC}

\url{https://github.com/TUM-LMF/MTLCC-pytorch}

\vspace{1em}
\small
\textsl{
	Rußwurm M., Körner M. (2018). \textbf{Multi-Temporal Land Cover Classification with Sequential Recurrent Encoders}. ISPRS International Journal of Geo-Information. https://arxiv.org/abs/1802.02080.
}
	
\end{frame}


\begin{frame}
\frametitle{Cloud coverage as spatiotemporal noise}
\centering

\def\imagewidth{1.5cm}


\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-0.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-1.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-2.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-3.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-4.png}}
\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-5.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-6.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-7.png}}
\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-8.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-9.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-10.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-11.png}}
\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-12.png}}
\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-13.png}}
\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-14.png}}
\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-15.png}}
\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-16.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-18.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-19.png}}
\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-20.png}}
\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-21.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-22.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-23.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-24.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-25.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-26.png}}
\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-27.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-28.png}}
\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-29.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-30.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-31.png}}
\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-32.png}}
\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-33.png}}
%	
\end{frame}


\begin{frame}
\frametitle{Common Filtering/Preprocessing Algorithms work quite well}

\begin{columns}
	\column{.5\textwidth}
	\begin{itemize}
		\item FMask
		\item MAJA
		\item Sen2Cor (F-Mask)
		\item supervised cloud classification e.g., CNNs
		\item unsupervised cloud clustering? {\small Go FDL!}
	\end{itemize}
	\column{.5\textwidth}
	
\end{columns}
\end{frame}


\begin{frame}
\frametitle{test}

\tikzstyle{conn} = [-stealth, rounded corners, tumbluedark, thick]
\tikzstyle{module} = [draw=none, fill=tumgraylight, rounded corners]
\tikzstyle{layer} = [draw=none, fill=tumbluelight, rounded corners]

\visible<2>{
	\begin{tikzpicture}[node distance=2em]
	\node(input){inputs};
	\node[below of=input](plus){+};
	\node[left of=plus](posenc){p};
	
	\node[module, below=2em of plus](attn){Multi-Head-Attention};
	\node[module, below=.5em of attn](addnorm){Add \& Norm};
	
	\node[module, below=2em of addnorm](ff){Feed Forward};
	\node[module, below=.5em of ff](addnorm2){Add \& Norm};
	
	
	\coordinate[above=of attn](in);
	\coordinate[below=of addnorm2](out);
	\draw[conn] (in) -- (attn);
	\draw[conn] (in) -- ($ (attn)!.5!(in) $) -| ($ (attn.north)+(2em,0) $);
	\draw[conn] (in) -- ($ (attn)!.5!(in) $) -| ($ (attn.north)-(2em,0) $);  
	%		
	\draw[conn] (in) -- ($ (attn)!.6!(in) $) -| ($ (attn.east)+(.5em,0) $) |- (addnorm.east);
	
	\draw[conn] (attn) -- (addnorm);
	
	\draw[conn] (addnorm) -- (ff);
	\draw[conn] (addnorm) -- ($ (addnorm)!.5!(ff) $) -| ($ (ff.east)+(.5em,0) $) |- (addnorm2.east);
	\draw[conn] (ff) -- (addnorm2);
	\draw[conn] (addnorm2) -- (out);
	
	\begin{pgfonlayer}{background}
	\node[layer, draw=black, fit=(attn)(addnorm)(ff)(addnorm2)(in)(out)]{};
	\end{pgfonlayer}
	
	\end{tikzpicture}
}

\end{frame}


\begin{frame}
\frametitle{Let's look at a few Examples}
\framesubtitle{Sentinel 2 preprocessed by \includegraphics[width=4em]{images/GAF_logo}}


\begin{tikzpicture}[baseline=-2em, inner sep=0]

\begin{axis}[
width=\textwidth,
%	hide axis,
height=5.5cm,
ymin=0, ymax=1.2,
%no marks,  
draw opacity=.8,
smooth=0.001,
legend style={at={(.65,1.1)},line width=2pt, draw opacity=1},
legend columns=3,
ylabel={reflectance},
xlabel={time $t$}
]

\only<1,2>{
	\addplot[b2color, tsmark] table [x=t, y=B02, col sep=comma] {images/example/12-71456800.csv};
	\addplot[b3color, tsmark] table [x=t, y=B03, col sep=comma] {images/example/12-71456800.csv};
	\addplot[b4color, tsmark] table [x=t, y=B04, col sep=comma] {images/example/12-71456800.csv};
	\addplot[b5color, tsmark] table [x=t, y=B05, col sep=comma] {images/example/12-71456800.csv};
	\addplot[b6color, tsmark] table [x=t, y=B06, col sep=comma] {images/example/12-71456800.csv};
	\addplot[b7color, tsmark] table [x=t, y=B07, col sep=comma] {images/example/12-71456800.csv};
	\addplot[b8color, tsmark] table [x=t, y=B08, col sep=comma] {images/example/12-71456800.csv};
	\addplot[b8Acolor, tsmark] table [x=t, y=B8A, col sep=comma] {images/example/12-71456800.csv};
	\addplot[b11color, tsmark] table [x=t, y=B11, col sep=comma] {images/example/12-71456800.csv};
	\addplot[b12color, tsmark] table [x=t, y=B12, col sep=comma] {images/example/12-71456800.csv};
}
\only<2>{
	\node[font=\Large](classannot) at (axis cs:12,1.1) {\textbf{meadow} \small(parcel 71456800)};
}
\only<3>{
	\addplot[b2color, tsmark] table [x=t, y=B02, col sep=comma]  {images/example/12-71460758.csv};
	\addplot[b3color, tsmark] table [x=t, y=B03, col sep=comma]  {images/example/12-71460758.csv};
	\addplot[b4color, tsmark] table [x=t, y=B04, col sep=comma]  {images/example/12-71460758.csv};
	\addplot[b5color, tsmark] table [x=t, y=B05, col sep=comma]  {images/example/12-71460758.csv};
	\addplot[b6color, tsmark] table [x=t, y=B06, col sep=comma]  {images/example/12-71460758.csv};
	\addplot[b7color, tsmark] table [x=t, y=B07, col sep=comma]  {images/example/12-71460758.csv};
	\addplot[b8color, tsmark] table [x=t, y=B08, col sep=comma]  {images/example/12-71460758.csv};
	\addplot[b8Acolor, tsmark] table [x=t, y=B8A, col sep=comma] {images/example/12-71460758.csv};
	\addplot[b11color, tsmark] table [x=t, y=B11, col sep=comma] {images/example/12-71460758.csv};
	\addplot[b12color, tsmark] table [x=t, y=B12, col sep=comma] {images/example/12-71460758.csv};
	
	\node[font=\Large](classannot) at (axis cs:12,1.1) {\textbf{meadow} \small(parcel 71460758)};
}
\only<4>{
	\addplot[b2color, tsmark] table [x=t, y=B02, col sep=comma]  {images/example/12-71460855.csv};
	\addplot[b3color, tsmark] table [x=t, y=B03, col sep=comma]  {images/example/12-71460855.csv};
	\addplot[b4color, tsmark] table [x=t, y=B04, col sep=comma]  {images/example/12-71460855.csv};
	\addplot[b5color, tsmark] table [x=t, y=B05, col sep=comma]  {images/example/12-71460855.csv};
	\addplot[b6color, tsmark] table [x=t, y=B06, col sep=comma]  {images/example/12-71460855.csv};
	\addplot[b7color, tsmark] table [x=t, y=B07, col sep=comma]  {images/example/12-71460855.csv};
	\addplot[b8color, tsmark] table [x=t, y=B08, col sep=comma]  {images/example/12-71460855.csv};
	\addplot[b8Acolor, tsmark] table [x=t, y=B8A, col sep=comma] {images/example/12-71460855.csv};
	\addplot[b11color, tsmark] table [x=t, y=B11, col sep=comma] {images/example/12-71460855.csv};
	\addplot[b12color, tsmark] table [x=t, y=B12, col sep=comma] {images/example/12-71460855.csv};
	
	\node[font=\Large](classannot) at (axis cs:12,1.1) {\textbf{meadow} \small(parcel 71460855)};
}
\only<5>{
	\addplot[b2color, tsmark] table [x=t, y=B02, col sep=comma]  {images/example/27-71460091.csv};
	\addplot[b3color, tsmark] table [x=t, y=B03, col sep=comma]  {images/example/27-71460091.csv};
	\addplot[b4color, tsmark] table [x=t, y=B04, col sep=comma]  {images/example/27-71460091.csv};
	\addplot[b5color, tsmark] table [x=t, y=B05, col sep=comma]  {images/example/27-71460091.csv};
	\addplot[b6color, tsmark] table [x=t, y=B06, col sep=comma]  {images/example/27-71460091.csv};
	\addplot[b7color, tsmark] table [x=t, y=B07, col sep=comma]  {images/example/27-71460091.csv};
	\addplot[b8color, tsmark] table [x=t, y=B08, col sep=comma]  {images/example/27-71460091.csv};
	\addplot[b8Acolor, tsmark] table [x=t, y=B8A, col sep=comma] {images/example/27-71460091.csv};
	\addplot[b11color, tsmark] table [x=t, y=B11, col sep=comma] {images/example/27-71460091.csv};
	\addplot[b12color, tsmark] table [x=t, y=B12, col sep=comma] {images/example/27-71460091.csv};
	
	\node[font=\Large](classannot) at (axis cs:12,1.1) {\textbf{wheat} \small(parcel 71460091)};
}
\only<6>{
	\addplot[b2color, tsmark] table [x=t, y=B02, col sep=comma]  {images/example/27-71460294.csv};
	\addplot[b3color, tsmark] table [x=t, y=B03, col sep=comma]  {images/example/27-71460294.csv};
	\addplot[b4color, tsmark] table [x=t, y=B04, col sep=comma]  {images/example/27-71460294.csv};
	\addplot[b5color, tsmark] table [x=t, y=B05, col sep=comma]  {images/example/27-71460294.csv};
	\addplot[b6color, tsmark] table [x=t, y=B06, col sep=comma]  {images/example/27-71460294.csv};
	\addplot[b7color, tsmark] table [x=t, y=B07, col sep=comma]  {images/example/27-71460294.csv};
	\addplot[b8color, tsmark] table [x=t, y=B08, col sep=comma]  {images/example/27-71460294.csv};
	\addplot[b8Acolor, tsmark] table [x=t, y=B8A, col sep=comma] {images/example/27-71460294.csv};
	\addplot[b11color, tsmark] table [x=t, y=B11, col sep=comma] {images/example/27-71460294.csv};
	\addplot[b12color, tsmark] table [x=t, y=B12, col sep=comma] {images/example/27-71460294.csv};
	
	\node[font=\Large](classannot) at (axis cs:12,1.1) {\textbf{wheat} \small(parcel 71460294)};
}
\only<7-8>{
	\addplot[b2color, tsmark] table [x=t, y=B02, col sep=comma]  {images/example/12-71459194.csv};
	\addplot[b3color, tsmark] table [x=t, y=B03, col sep=comma]  {images/example/12-71459194.csv};
	\addplot[b4color, tsmark] table [x=t, y=B04, col sep=comma]  {images/example/12-71459194.csv};
	\addplot[b5color, tsmark] table [x=t, y=B05, col sep=comma]  {images/example/12-71459194.csv};
	\addplot[b6color, tsmark] table [x=t, y=B06, col sep=comma]  {images/example/12-71459194.csv};
	\addplot[b7color, tsmark] table [x=t, y=B07, col sep=comma]  {images/example/12-71459194.csv};
	\addplot[b8color, tsmark] table [x=t, y=B08, col sep=comma]  {images/example/12-71459194.csv};
	\addplot[b8Acolor, tsmark] table [x=t, y=B8A, col sep=comma] {images/example/12-71459194.csv};
	\addplot[b11color, tsmark] table [x=t, y=B11, col sep=comma] {images/example/12-71459194.csv};
	\addplot[b12color, tsmark] table [x=t, y=B12, col sep=comma] {images/example/12-71459194.csv};
	
}
\only<7>{
	\node[font=\Huge](classannot) at (axis cs:12,1.1) {\textbf{meadow or wheat?}};
}
\only<8>{
	\node[font=\Large](classannot) at (axis cs:12,1.1) {\textbf{meadow} \small(parcel 71459194)};
}


%
\only<1>{
	\legend{B02 (blue),B03 (green),B04 (red),B05,B06,B07,B08,B8A,B11,B12}
}

\end{axis}

\end{tikzpicture}

\end{frame}


{\setbeamercolor{background canvas}{bg=tumbluedark}
\begin{frame}[plain]

\vspace{8em}
\begin{center}
	\Huge\color{tumwhite}
	we just trained an \textbf{Ensemble} of \textbf{human classifiers} \\ \raggedleft {\normalsize (on 5 training samples)}
\end{center}\color{white}

\end{frame}
}


\begin{frame}
\frametitle{Self-Attention Block 1}
\framesubtitle{Head 1}
\centering\includegraphics[width=.85\textwidth]{images/self-attention/transformer/self-attention-1}
\end{frame}


\begin{frame}
\frametitle{Self-Attention Block 2}
\framesubtitle{Head 1}
\centering\includegraphics[width=.85\textwidth]{images/self-attention/transformer/self-attention-2}
\end{frame}


\begin{frame}
\frametitle{Self-Attention Block 3}
\framesubtitle{Head 1}
\centering
\begin{tikzpicture}
\node(a){\includegraphics[width=.85\textwidth]{images/self-attention/transformer/self-attention-3}};
\node[fill=tumbluedark, text=white, rounded corners, font=\Large, yshift=-2cm] at (a){maxpooling};
\end{tikzpicture}
\end{frame}

\begin{frame}
\frametitle{Classification Scores after Outlinear + Softmax}
\includegraphics[width=.85\textwidth]{images/self-attention/transformer/outlinear}
\end{frame}


\begin{frame}
\frametitle{Introducing Notation}


\begin{tikzpicture}[baseline=-2em, inner sep=0]

\begin{axis}[
width=\textwidth,
%	hide axis,
height=5.5cm,
ymin=0, ymax=1.2,
%no marks,  
draw opacity=.8,
smooth=0.001,
legend style={at={(.65,1.1)},line width=2pt, draw opacity=1},
legend columns=3,
ylabel={reflectance},
xlabel={time $t$}
]

\addplot[b2color, tsmark, opacity=.6] table [x=t, y=B02, col sep=comma] {images/example/12-71456800_raw.csv};
\addplot[b3color, tsmark, opacity=.6] table [x=t, y=B03, col sep=comma] {images/example/12-71456800_raw.csv};
\addplot[b4color, tsmark, opacity=.6] table [x=t, y=B04, col sep=comma] {images/example/12-71456800_raw.csv};
\addplot[b5color, tsmark, opacity=.6] table [x=t, y=B05, col sep=comma] {images/example/12-71456800_raw.csv};
\addplot[b6color, tsmark, opacity=.6] table [x=t, y=B06, col sep=comma] {images/example/12-71456800_raw.csv};
\addplot[b7color, tsmark, opacity=.6] table [x=t, y=B07, col sep=comma] {images/example/12-71456800_raw.csv};
\addplot[b8color, tsmark, opacity=.6] table [x=t, y=B08, col sep=comma] {images/example/12-71456800_raw.csv};
\addplot[b8Acolor, tsmark, opacity=.6] table [x=t, y=B8A, col sep=comma] {images/example/12-71456800_raw.csv};
\addplot[b11color, tsmark, opacity=.6] table [x=t, y=B11, col sep=comma] {images/example/12-71456800_raw.csv};
\addplot[b12color, tsmark, opacity=.6] table [x=t, y=B12, col sep=comma] {images/example/12-71456800_raw.csv};

\node[draw=tumbluedark, rounded corners, inner sep=0, minimum width=.8em, minimum height=3em](xt) at (axis cs:32,0.22){};
\node[font=\Large] (annotxt) at (axis cs:38,1.05){$\V{x}_t = 
	\begin{pmatrix} \rho_\text{B02} \\ \vdots \\ \rho_\text{B12} \end{pmatrix} = 
	\left(\xtvector\right)$};
\draw[-stealth] (annotxt) -- (xt);

%
%\only<1>{
%	\legend{B02 (blue),B03 (green),B04 (red),B05,B06,B07,B08,B8A,B11,B12}
%}

\end{axis}

\end{tikzpicture}

\end{frame}

\begin{frame}
\frametitle{Introducing Notation}

\vspace{-2em}

\begin{tikzpicture}
\node[](X){$\left(
\begin{tikzpicture}[baseline=-4em,yscale=-.25, xscale=.4]
\foreach \x in {0,...,22}{
	\node[draw=tumgraylight, circle, fill=b2color, text=white, text opacity=1, font=\small, inner sep=.2em](d) at (\x,0){};
	\node[draw=tumgraylight, circle, fill=b3color, text=white, text opacity=1, font=\small, inner sep=.2em](d) at (\x,1){};
	\node[draw=tumgraylight, circle, fill=b4color, text=white, text opacity=1, font=\small, inner sep=.2em](d) at (\x,2){};
	\node[draw=tumgraylight, circle, fill=b5color, text=white, text opacity=1, font=\small, inner sep=.2em](d) at (\x,3){};
	\node[draw=tumgraylight, circle, fill=b6color, text=white, text opacity=1, font=\small, inner sep=.2em](d) at (\x,4){};
	\node[draw=tumgraylight, circle, fill=b7color, text=white, text opacity=1, font=\small, inner sep=.2em](d) at (\x,5){};
	\node[draw=tumgraylight, circle, fill=b8color, text=white, text opacity=1, font=\small, inner sep=.2em](d) at (\x,6){};
	\node[draw=tumgraylight, circle, fill=b8Acolor, text=white, text opacity=1, font=\small, inner sep=.2em](d) at (\x,7){};
	\node[draw=tumgraylight, circle, fill=b11color, text=white, text opacity=1, font=\small, inner sep=.2em](d) at (\x,8){};
	\node[draw=tumgraylight, circle, fill=b12color, text=white, text opacity=1, font=\small, inner sep=.2em](d) at (\x,9){};
}
\end{tikzpicture}\right) \Huge \in \mathbb{R}^{D \times T}$};

\node[draw, rounded corners, xshift=1.85em, minimum width=1em, minimum height=8.5em, label={[name=featurevector]above:$\V{x}_t$}] at (X){};

\node[left=.5em of X, font=\Huge](Xmatr){$\M{X} = $};


\node[above=4em of Xmatr, xshift=2em] (annotmatrix){Input Matrix};
\node[above=1em of featurevector] (annotfeat){feature vector at time $t$};

\draw[-stealth] (annotfeat) -- (featurevector);
\draw[-stealth] (annotmatrix) -- (Xmatr);

\node[below=5em of Xmatr, font=\Huge](yvect){$\V{y} = $};

\node[right=.1em of yvect](gt){$\begin{pmatrix}
{y}_i\\ \vdots \\ {y}_C
\end{pmatrix} = \left(\drawprobas{0}{0}{0}{100}{0}\right) \text{where}~y_i \in \{0,1\}$};

\node[right=1em of gt, font=\Huge](yvect2){$\yhat =$};
\node[right=.1em of yvect2](gt2){$\begin{pmatrix}
\hat{y}_i\\ \vdots \\ \hat{y}_C
\end{pmatrix} = \left(\drawprobas{10}{30}{10}{90}{10}\right) \text{where}~\hat{y}_i \in [0,1]$ and $C$ classes};

\node[below=2em of yvect, xshift=2em] (annoty){ground truth};

\node[below=2em of yvect2, xshift=2em] (annoty2){prediction};
\draw[-stealth] (annoty) -- (yvect);
\draw[-stealth] (annoty2) -- (yvect2);

%	\node[below right=of Xmatr] (annotmatrix){Input Matrix};
\end{tikzpicture}
\end{frame}