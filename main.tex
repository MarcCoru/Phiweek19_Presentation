\documentclass[%
  aspectratio=169,
  9pt,
%   t,
%  USenglish,
ngerman,
%   dark,
  light,
  mathserif,
%   serif, 
  professionalfont,
%  handout,
%  affiliationinhead,
  affiliationintitlepagehead,
  titlegraphic,
  %% The following options would violate the CD rules!
   affiliation,
%   uselogos,
   navigationbar,
  progressbar,
%   seprules,
%   titleinhead,
]{beamer}

\usepackage[utf8]{inputenc}
\usepackage[english, ngerman]{babel}
\usepackage[]{csquotes}

\usepackage{siunitx}

\sisetup{%
	mode = math,
	detect-family,
	detect-weight,  
	exponent-product = \cdot,
	number-unit-separator=\text{\,},
	output-decimal-marker={\text{,}},
	math-rm=\mathsf,
	text-rm=\sffamily,
}

\usepackage{animate}
%\usepackage{MnSymbol,wasysym}


%\newcommand{\org}{LMF}
% \newcommand{\org}{FPF}
%\newcommand{\coorg}{DLR}
\newcommand{\boldstruct}[1]{\textbf{\structure{#1}}}
\usetheme{TUM}
\usepackage{glossaries}
\usepackage{graphicx}
\usepackage{nth}
%\usepackage{natbib}
\usepackage[square,sort,comma,numbers]{natbib}
\bibliographystyle{abbrvnat}
\setcitestyle{authoryear}%,open={((},close={))}

\usepackage{tummath}
\usepackage{tumtensors} % experimental
\usepackage{tumcolors}
\usepackage{subfigure}
\usepackage[noabbrev, capitalize]{cleveref}
\usepackage{csvsimple}
\usepackage{colortbl}
\usepackage{tabularx}
\usepackage{multimedia}

\PassOptionsToPackage{cmyk}{xcolors}
	
\usepackage{booktabs}
\usepackage{contour}

%\usepackage{biblatex}
%\addbibresource{bib/ijgi}

\usepackage{pgfplots}
\usepgfplotslibrary{groupplots}
\usepackage{pgfplotstable}
\usepgfplotslibrary{dateplot}

%\usepgfplotslibrary{external}
%\tikzexternalize

\usepackage{booktabs}
\usepackage{array}
\newcolumntype{x}{l}
\newcolumntype{X}{>{}l}
\newcolumntype{v}[1]{>{\raggedright\hspace{0pt}}p{#1}}
\newcolumntype{V}[1]{>{\scriptsize\raggedright\hspace{0pt}}p{#1}}


\definecolor{fusionremovedcolor}{HTML}{00CA43}
\definecolor{fusionaddedcolor}{HTML}{FF00F7}
\definecolor{overlapcolor}{HTML}{FAC843}

\usepgfplotslibrary{external}
%\tikzexternalize
\tikzsetexternalprefix{tikz/}

\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}

%\usetikzlibrary{mindmap}

%\usetikzlibrary{arrows} 
%\usetikzlibrary{backgrounds}
\usetikzlibrary{fit}
%\usetikzlibrary{shapes}
\usetikzlibrary{calc}
\usetikzlibrary{positioning}
\usetikzlibrary{matrix}
\usepackage[nodayofweek,level]{datetime}
%\usepackage{mwe}
%%
%
\usetikzlibrary{3d}
\tikzstyle{perspective3d}=[
x={(0.5cm,0.5cm)}, y={(1cm,0cm)}, z={(0cm,1cm)}]


\colorlet{traincolor}{tumbluelight}
\colorlet{validcolor}{tumbluedark}
\colorlet{evalcolor}{tumorange}

\colorlet{forwardcolor}{tumblue}
\colorlet{backwardcolor}{tumorange}

\colorlet{activationcolor}{tumblue}
\colorlet{gridcolor}{tumgraylight}
\colorlet{contextonecolor}{tumorange}
\colorlet{contexttwocolor}{tumorange!80}
\colorlet{contextthreecolor}{tumorange!60}
\colorlet{contextfourcolor}{tumorange!40}

% defaultvalue -> might be replaced later
\colorlet{tensorcolor}{forwardcolor}

\colorlet{classcolor}{tumivory}
\colorlet{encodercolor}{tumblue}
\colorlet{encodercolor}{tumred}

%\usepackage{media9}

% notation
\newcommand{\MWeight}{\ensuremath{\M{W}}}
\newcommand{\VBias}{\ensuremath{\V{b}}}
\newcommand{\VInput}{\DataVec}
\newcommand{\VHidden}{\ensuremath{\V{h}}}
\newcommand{\FActivation}{\ensuremath{\sigma}}
\newcommand{\VCellState}{\ensuremath{\V{c}}}
\newcommand{\VForgetGate}{\ensuremath{\V{f}}}
\newcommand{\VModulationGate}{\ensuremath{\V{j}}}
\newcommand{\VInputGate}{\ensuremath{\V{i}}}
\newcommand{\VOutputGate}{\ensuremath{\V{o}}}



\newcommand{\VResetGate}{\ensuremath{\V{r}}}
\newcommand{\VUpdateGate}{\ensuremath{\V{u}}}

%\newcommand{\concat}[2]{\VecDef{#1 \Vert #2}}
\newcommand{\concat}[2]{[#1\Vert#2]}

\newcommand{\Rin}[3]{\mathbb{R}^{[#1 \times #2 \times #3]}}
\newcommand{\Rinfloor}[3]{\mathbb{R}^{[#1]} \times \mathbb{R}^{[#2]} \times \mathbb{R}^{[#3]}}
\newcommand{\Rinfour}[4]{\mathbb{R}^{[#1 \times #2 \times #3 \times #4]}}

% kernel size of rnn convolution
\newcommand{\krnn}{k_{rnn}}
% kernel size of classification convolution
\newcommand{\kclass}{k_{class}}

\newcommand{\eg}{e.g., }
\newcommand{\ie}{i.e. }

%\newcommand{\classname}[1]{\texttt{#1}}
\newcommand{\classname}[1]{\textsl{#1}} % what about \textsl for classnames?
\newcommand{\cn}[1]{\classname{#1}} % short alias

\newcommand{\nutzungscn}[1]{\textsc{#1}} % stmelf Nutzungsklassen

\newcommand{\brand}[1]{\textsc{#1}}
\newcommand{\processing}[1]{\brand{#1}}
\newcommand{\satellite}[1]{\brand{#1}}
\newcommand{\band}[1]{\brand{#1}}

% https://tex.stackexchange.com/questions/167925/how-to-make-maths-equations-start-at-the-left
\newcommand{\mathleft}{\@fleqntrue\@mathmargin0pt}
\newcommand{\mathcenter}{\@fleqnfalse}

\usetikzlibrary{spy}

% \usepackage[ngerman]{babel} % if you get errors on compile: rm *aux *out *log *nav *snm *toc

\newcommand{\rastergrid}{
	\input{images/rastergrid.tikz}
}
\newcommand{\vectorgrid}{
	\input{images/vectorgrid.tikz}
}

%\setbeamersize{description width=0mm}

\mode<handout>{
  \usepackage{pgfpages}
% feel free to use one of these layouts
%   \pgfpagesuselayout{1 on 1}[a4paper,border shrink=5mm]
  \pgfpagesuselayout{2 on 1}[a4paper,border shrink=5mm]
%   \pgfpagesuselayout{3 on 1}[a4paper,border shrink=5mm]
%   \pgfpagesuselayout{4 on 1}[a4paper,border shrink=5mm]
%   \pgfpagesuselayout{2 on 1 landscape}[a4paper,border shrink=5mm]
%   
% you can also add room for notes, but then the widescreen aspect ratio messes up a little
%   \usepackage{handoutWithNotes}
%   \pgfpagesuselayout{1 on 1 with notes}[a4paper,border shrink=5mm]
%   \pgfpagesuselayout{2 on 1 with notes}[a4paper,border shrink=5mm]
%   \pgfpagesuselayout{3 on 1 with notes}[a4paper,border shrink=5mm]
%   \pgfpagesuselayout{4 on 1 with notes}[a4paper,border shrink=5mm]
%   \pgfpagesuselayout{1 on 1 with notes landscape}[a4paper,border shrink=5mm]
%   \pgfpagesuselayout{2 on 1 with notes landscape}[a4paper,border shrink=5mm]
}


\setbeamercovered{transparent}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Convolutional-Recurrent Networks for Multi-temporal Classification
\title{Convolutional LSTMs for Cloud-Robust Classification \\ of Remote Sensing Imagery}
%\subtitle{NeurIPS 2018 Workshop on Spatiotemporal Modeling and Decision-making}
\subtitle{$\Phi$-week 2019}
\author[M. Rußwurm, M. Körner]{Marc Rußwurm, Marco Körner}
\institute[TUM]{Technical University of Munich\\Chair of Remote Sensing Technology\\Computer Vision Research Group\\\url{www.lmf.bgu.tum.de/vision}}

\date{13th September 2019, ESA ESRIN, Frascati, Italy}

\begin{document}

\begin{frame}[t]
  \titlepage
\end{frame}

\begin{frame}
\frametitle{When we think of satellite images we picture this}
%\centering\includegraphics[width=.75\textwidth]{images/montreal_satellite}
\includegraphics[width=\textwidth]{images/cloudfree}
\end{frame}

\begin{frame}
	\frametitle{... however, ususally }
		\includegraphics[width=\textwidth]{images/clouds}
	
%		\includegraphics[width=\textwidth]{images/cloud_airplane}
		
\end{frame}

\begin{frame}
	\frametitle{Cloud coverage as spatiotemporal noise}
	\centering
	
	\def\imagewidth{1.5cm}
	
	
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-0.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-1.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-2.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-3.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-4.png}}
	\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-5.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-6.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-7.png}}
	\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-8.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-9.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-10.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-11.png}}
	\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-12.png}}
	\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-13.png}}
	\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-14.png}}
	\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-15.png}}
	\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-16.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-18.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-19.png}}
	\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-20.png}}
	\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-21.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-22.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-23.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-24.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-25.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-26.png}}
	\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-27.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-28.png}}
	\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-29.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-30.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-31.png}}
	\visible<1,2>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-32.png}}
	\visible<1>{\includegraphics[width=\imagewidth]{images/activations/16494/x/x-33.png}}
%	
\end{frame}
%
%\begin{frame}
%\LARGE
%\centering
%\textbf{Filter this temporal noise by pre-classificaition?}
%\end{frame}

%\begin{frame}
%		\input{images/scl.tikz}
%\end{frame}


\input{images/overviewgraphs.tikz}

\begin{frame}<presentation:0>

\frametitle{Detecting Clouds is rarely the main objective}
\LARGE
\centering\figcloudfilteringpipeline

\end{frame}

%


%\begin{frame}<presentation:1>
%
%\frametitle{Introducing a model to pre-classify clouds?}
%\LARGE
%\centering\figcloudfilteringpipeline
%
%\end{frame}

%\begin{frame}
%\frametitle{Clouds classification works very well...}
%
%\includegraphics[width=\textwidth]{images/Li18_clouds}
%
%\texttt{\small Li, Z., Shen, H., Cheng, Q., Liu, Y., You, S., \& He, Z. (2018). Deep learning based cloud detection for remote sensing images by the fusion of multi-scale convolutional features. arXiv preprint arXiv:1810.05801.}
%\end{frame}
%
%\begin{frame}<presentation:2>
%
%\frametitle{Identifying clouds is rarely the main objective!}
%\LARGE
%\centering\figcloudfilteringpipeline
%
%\end{frame}

\begin{frame}
	\frametitle{Common Filtering/Preprocessing Algorithms work quite well}
	
	\begin{columns}
		\column{.5\textwidth}
		\begin{itemize}
			\item FMask
			\item MAJA
			\item Sen2Cor (F-Mask)
			\item supervised cloud classification e.g., CNNs
			\item unsupervised cloud clustering? {\small Go FDL!}
		\end{itemize}
		\column{.5\textwidth}
	
	\end{columns}
\end{frame}

%
%\begin{frame}
%\frametitle{End-to-end trainable model for robust classification}
%\LARGE
%\centering\figourapproach		
%
%\end{frame}

\begin{frame}
	\frametitle{Gated Recurrence}
	
	
\end{frame}

\newcommand{\attention}{
\begin{tikzpicture}[scale=0.6]
\node[draw=tumred, circle, fill=tumred, fill opacity=.4, text opacity=1, font=\small, inner sep=.2em](a) at (1,0){.2};
\node[draw=tumred, circle, fill=tumred, fill opacity=.8, text opacity=1, font=\small, inner sep=.2em](b) at (2,0){.4};
\node[draw=tumred, circle, fill=tumred, fill opacity=.2, text opacity=1, font=\small, inner sep=.2em](c) at (3,0){.1};
\node[draw=tumred, circle, fill=tumred, fill opacity=.6, text opacity=1, font=\small, inner sep=.2em](d) at (4,0){.3};
\end{tikzpicture}
}

\newcommand{\attnv}{
	\begin{tikzpicture}[scale=0.6]
	\node[draw=tumbluelight, circle, fill=tumblue, fill opacity=.2, text opacity=1, font=\small, inner sep=.2em](a) at (0, 1){.2};
	\node[draw=tumbluelight, circle, fill=tumblue, fill opacity=.1, text opacity=1, font=\small, inner sep=.2em](b) at (0, 2){.1};
	\node[draw=tumbluelight, circle, fill=tumblue, fill opacity=.3, text opacity=1, font=\small, inner sep=.2em](c) at (0, 3){.3};
	\node[draw=tumbluelight, circle, fill=tumblue, fill opacity=.4, text opacity=1, font=\small, inner sep=.2em](d) at (0, 4){.4};
	\end{tikzpicture}
}

\newcommand{\attnout}{
	\begin{tikzpicture}[scale=0.25]
	\node[draw=tumblack, circle, fill=tumbluedark, text=white, text opacity=1, font=\small, inner sep=.2em](d) at (4,0){.27};
	\end{tikzpicture}
}

\begin{frame}
	\frametitle{Attention}
	
	\begin{columns}
		\column{.5\textwidth}
%		
%		
%		\attention
%		
%		\attnv
		
		\begin{tikzpicture}[node distance=.2em]
		\node[label={below:$\alpha$}](alpha){\attention};
		\node[right=of alpha](out){\attnout};
		\node[above=of out, label={right:$V$}]{\attnv};
		\end{tikzpicture}
		
		%	\begin{equation*}
		%		\text{Attention}(Q,K,V) = 
		%		\begin{tikzpicture}
		%		\node(alpha){$\underbrace{\attention}_\alpha$};
		%		\node[right=of alpha](out){};
		%		\node[above=of out]{\attnv};
		%		\end{tikzpicture}
		%		 
		%	\end{equation*}
		
		
		\column{.5\textwidth}
		
		\begin{tikzpicture}[yscale=3]
			\node[draw=tumbluelight, circle, fill=tumblue, fill opacity=.2, text opacity=1, font=\small, inner sep=.2](a) at (1,.3){.3};
			\node[draw=tumbluelight, circle, fill=tumblue, fill opacity=.1, text opacity=1, font=\small, inner sep=.2](b) at (2,.1){.1};
			\node[draw=tumbluelight, circle, fill=tumblue, fill opacity=.3, text opacity=1, font=\small, inner sep=.2](c) at (3,.3){.3};
			\node[draw=tumbluelight, circle, fill=tumblue, fill opacity=.4, text opacity=1, font=\small, inner sep=.2](d) at (4,.4){.4};
			
			\draw (a) -- (b) -- (c) -- (d);
			
			\foreach \t in {1,2,3,4} {
				\draw (\t,0) -- (\t,-.05) node[at end, below] {$t_\t$};
			}
			
			%\draw[-stealth] (0,0) -- (0,.5);
			\draw[-stealth] (.5,0) -- (4.5,0);
			
			\node[draw=tumblack, circle, fill=tumorange, fill opacity=.4, text opacity=1, font=\small, inner sep=.2em, label={right:$\sum_{t=0}^{T} \alpha_tv_t$}](out) at (2.5,-.5) {};
			
			\node at (2.5, -.25) {};
			
			\draw[-stealth, draw=tumred, opacity=.4, line width=.4] (1,0) -- (out);
			\draw[-stealth, draw=tumred, opacity=.8, line width=.8] (2,0) -- (out);
			\draw[-stealth, draw=tumred, opacity=.2, line width=.2] (3,0) -- (out);
			\draw[-stealth, draw=tumred, opacity=.6, line width=.6] (4,0) -- (out);
			
			\node(annot1) at (1.5,.7){keep};
			\draw[-stealth, tumred, shorten <= 1em, , shorten >= 1em](annot1) -- (b);
			\draw[-stealth, tumred, shorten <= 1em, , shorten >= 1em](annot1.east) -- (d);
			
			\node(annot2) at (3.5,.85){ignore};
			\draw[-stealth, tumbluelight, shorten <= 1em, shorten >= 1em](annot2) -- (a);
			\draw[-stealth, tumbluelight, shorten <= 1em, shorten >= 1em](annot2) -- (c);
			
			
		\end{tikzpicture}
%		
%		
%		\begin{tikzpicture}
%		\begin{axis}[height=3cm,width=\textwidth,grid=major,]
%		\addplot coordinates {(0,.3) (1,.1) (2,.3) (3,.4)};
%		\end{axis}
%		\end{tikzpicture}
%		\begin{tikzpicture}
%			
%			\begin{axis}[ybar,height=3cm,width=\textwidth,grid=major,]
%			\addplot coordinates {(1,.05) (0,.4) (3,.05) (2,.5)};
%			\end{axis}
%		\end{tikzpicture}
	\end{columns}

	
	\Large
	\begin{equation*}
	\text{Attention}({\color{tumred}\alpha}, {\color{tumblue}V}) = {\color{tumred}\alpha}^T  {\color{tumblue}V}\sum_{t=0}^{T} \alpha_tv_t, \quad \alpha \in [0,1]^T=4, V \in \mathbb{R}^{T}
	\end{equation*}
	
\end{frame}


\begin{frame}
	
	
	\begin{equation*}
	\text{Attention}(Q,K,V) = \underbrace{\text{softmax}\left(QK^T\right)}_\alpha V
	\end{equation*}
	query: $Q \in \mathbb{R}^{t \times d_k}$
	
	key: $K \in \mathbb{R}^{t \times d_k}$
	
	value: $V \in \mathbb{R}^{t \times d_v}$
	
	attention scores $\alpha \in [0,1]^{t \times t}$
	
	
\end{frame}

\def\fps{3}
\input{images/cells.tikz}

\begin{frame}
	\frametitle{test}
	
	\tikzstyle{conn} = [-stealth, rounded corners, tumbluedark, thick]
	\tikzstyle{module} = [draw=none, fill=tumgraylight, rounded corners]
	\tikzstyle{layer} = [draw=none, fill=tumbluelight, rounded corners]
	
	\visible<2>{
	\begin{tikzpicture}[node distance=2em]
		\node(input){inputs};
		\node[below of=input](plus){+};
		\node[left of=plus](posenc){p};
		
		\node[module, below=2em of plus](attn){Multi-Head-Attention};
		\node[module, below=.5em of attn](addnorm){Add \& Norm};
		
		\node[module, below=2em of addnorm](ff){Feed Forward};
		\node[module, below=.5em of ff](addnorm2){Add \& Norm};
		
		
		\coordinate[above=of attn](in);
		\coordinate[below=of addnorm2](out);
		\draw[conn] (in) -- (attn);
		\draw[conn] (in) -- ($ (attn)!.5!(in) $) -| ($ (attn.north)+(2em,0) $);
		\draw[conn] (in) -- ($ (attn)!.5!(in) $) -| ($ (attn.north)-(2em,0) $);  
%		
		\draw[conn] (in) -- ($ (attn)!.6!(in) $) -| ($ (attn.east)+(.5em,0) $) |- (addnorm.east);

		\draw[conn] (attn) -- (addnorm);
		
		\draw[conn] (addnorm) -- (ff);
		\draw[conn] (addnorm) -- ($ (addnorm)!.5!(ff) $) -| ($ (ff.east)+(.5em,0) $) |- (addnorm2.east);
		\draw[conn] (ff) -- (addnorm2);
		\draw[conn] (addnorm2) -- (out);
		
		\begin{pgfonlayer}{background}
			\node[layer, draw=black, fit=(attn)(addnorm)(ff)(addnorm2)(in)(out)]{};
		\end{pgfonlayer}
		
	\end{tikzpicture}
}
	
\end{frame}

\begin{frame}[t]
\frametitle{Extracting features from noisy data with ConvRNNs}

\centering
		%\lstmanim
		\begin{tikzpicture}[scale=1, node distance=2em]%,show background rectangle,background rectangle/.style={draw=red}]
		
		
		\draw pic (LSTM) at (0,0) {lstmanim};
		\node[io,xshift=1ex,above=3em of LSTMtl, ,label=above:$\VInput_{t}$](xt){\animategraphics[poster=25,width=1cm,autoplay,loop]{\fps}{images/activations/16494/x/x-}{1}{36}};%$x_{t}$
		\draw[rounded corners] (xt) |- (LSTM-input);
		\node[io,left=of LSTMtl,label=below:$\VHidden_{t-1}$](htminus1){
			\animategraphics[poster=24,width=1cm,autoplay,loop]{\fps}{images/activations/16494/output/3-}{0}{35}
		};
		\draw[endflow] (htminus1) -- (LSTM-input);
		\node[io,right=of LSTMbr,label=above:$\VCellState_{t}$](ct){\animategraphics[poster=25,width=1cm,autoplay,loop]{\fps}{images/activations/16494/state/3-}{1}{36}}; % $c_{t}$
		\draw[endflow] (LSTM-coutput)--(ct);
		\node[io,left=of LSTMbl,label=above:$\VCellState_{t-1}$](ctminus1){\animategraphics[poster=24,width=1cm,autoplay,loop]{\fps}{images/activations/16494/state/3-}{0}{35}}; % 
		\draw[endflow] (ctminus1)--(LSTMfmult);
		\node[io,right=of LSTMtr,label=below:$\VHidden_{t}$](ht){
			\animategraphics[poster=24,width=1cm,autoplay,loop]{\fps}{images/activations/16494/output/3-}{1}{36}
		};
		\draw[endflow] (LSTM-houtput)--(ht);
		
		\draw[endflow] (ct) -- ($ (ct)+(0,-0.8) $) -| (ctminus1);
		\draw[endflow] (ht) -- ($ (ht)+(0,.8) $) -| (htminus1);
		
		\end{tikzpicture}
	
\end{frame}

\begin{frame}<presentation:3>
	\frametitle{Employ ConvRNNs for Vegetation Land Cover Classification directly}
%	\input{images/seqencnetwork.tikz}
%	\figseqencnetwork
	\input{images/network.tikz}
%	
%	\input{images/lstm.tikz}
%	\lstmanimtwo
t\end{frame}

\begin{frame}
\frametitle{It worked very well}
\input{approaches_transposed.tex}
\end{frame}

%\input{images/examples.tex}
%\begin{frame}
%\frametitle{Qualitative Examples}
%%	\framesubtitle{ConvGRU with r=256 recurrent cells}
%\centering
%\begin{tikzpicture}
%\matrix (m) [matrix of nodes, ampersand replacement=\&, row sep=0pt, column sep=2mm]{
%	$\V{x}_{RGB,t}$ \& labels $\V{y}$ \& pred. $\hat{\V{y}}$ \& $H(\V{y},\hat{\V{y}}$) \& activation \& activation \& activation \& activation
%	\tileexample{16494}{maize}{maize}{meadow}{meadow}{peas}{peas}{rape}{rape}
%	\tileexample{8133}{winter_spelt}{spelt}{winter_wheat}{wheat}{summer_barley}{s.barley}{maize}{maize}
%	\tileexample{12894}{meadow}{meadow}{winter_wheat}{wheat}{potatoe}{potato}{maize}{maize}
%	%		\tileexample{1823}{meadow}{meadow}{winter_wheat}{wheat}{summer_oat}{oat}{maize}{maize}
%	\\
%};
%\makeexamplelegend
%\end{tikzpicture}
%\end{frame}

%\begin{frame}
%\frametitle{Qualitative Examples}
%%	\framesubtitle{ConvGRU with r=256 recurrent cells}
%\centering
%\begin{tikzpicture}
%\matrix (m) [matrix of nodes, ampersand replacement=\&, row sep=0pt, column sep=2mm]{
%$\V{x}_{RGB,t}$ \& labels $\V{y}$ \& pred. $\hat{\V{y}}$ \& $H(\V{y},\hat{\V{y}}$) \& activation \& activation \& activation \& activation
%\tileexample{10879}{winter_rye}{rye}{winter_triticale}{triticale}{summer_barley}{s.barley}{winter_barley}{w.barley}
%\tileexample{10792}{winter_rye}{rye}{winter_wheat}{wheat}{winter_triticale}{triticale}{summer_barley}{s.barley}
%%		\tileexample{10969}{winter_wheat}{wheat}{winter_triticale}{triticale}{winter_rye}{rye}{rape}{rape}
%\tileexample{172}{winter_wheat}{wheat}{meadow}{meadow}{maize}{maize}{winter_barley}{w.barley}
%\\
%};
%\makeexamplelegend
%\end{tikzpicture}
%\end{frame}


%\begin{frame}
%\frametitle{How did the ConvRNN handle the cloud noise?}
%
%We performed two experiments
%\begin{enumerate}
%	\item Visualization of internal network states. We found some hidden states that were sensitive 
%\end{enumerate}
%
%\end{frame}

\begin{frame}
\LARGE
\centering
\textbf{How did the ConvLSTM handle the clouds?}
\end{frame}


\begin{frame}
\frametitle{Experiments}
\LARGE
1. \textbf{Visualization of hidden states}

{\hspace{2em} we found specific states dedicated for cloud masking.}

\vspace{2em}
2. \textbf{Ablation experiment on different cloud coverages} 

{\hspace{2em} similar accuracies on different degrees of cloud coverage.}

\end{frame}

\begin{frame}
	\frametitle{Takeaways \& Poster}
	
	\LARGE
	1. \textbf{ConvRNNs were very robust when considering noisy data}
	
	\vspace{2em}
	2. \textbf{Would love to hear other's experiences on this}
	
\end{frame}

%\begin{frame}
%\frametitle{Looking back at the Unreasonable Effectiveness of RNNs Blog}
%\texttt{http://karpathy.github.io/2015/05/21/rnn-effectiveness/}
%\includegraphics[width=\textwidth]{images/karpathy_charrnn}
%\end{frame}

%\input{images/activations.tikz}
%\begin{frame}
%\frametitle{Cloud Sensitive Cells}
%\framesubtitle{LSTM cell \textbf{47} of 256}
%\figactivations{1}{47}
%\end{frame}
%
%\begin{frame}
%\frametitle{Ablation Experiment on Cloudy Data}
%\input{images/clouds.tikz}
%\end{frame}

\begin{frame}[c]
\frametitle{Publications and Code}
\centering 

\Large



Github + DockerHub

\vspace{1ex}

\includegraphics[width=2cm]{images/github} \hspace{.5ex}
\includegraphics[width=2cm]{images/qr_github} \hspace{.5ex}
\includegraphics[width=2cm]{images/docker}

\vspace{1ex}

\url{https://github.com/TUM-LMF/MTLCC}

\url{https://github.com/TUM-LMF/MTLCC-pytorch}

\vspace{1em}
\small
\textsl{
	Rußwurm M., Körner M. (2018). \textbf{Multi-Temporal Land Cover Classification with Sequential Recurrent Encoders}. ISPRS International Journal of Geo-Information. https://arxiv.org/abs/1802.02080.
}
	
\end{frame}

\end{document}


